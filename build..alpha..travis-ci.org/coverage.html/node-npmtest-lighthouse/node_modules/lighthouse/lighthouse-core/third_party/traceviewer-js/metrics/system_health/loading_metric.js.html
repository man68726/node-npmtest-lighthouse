<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-lighthouse/node_modules/lighthouse/lighthouse-core/third_party/traceviewer-js/metrics/system_health/loading_metric.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-lighthouse">npmtest-lighthouse (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-lighthouse/node_modules/lighthouse/lighthouse-core/third_party/traceviewer-js/metrics/system_health/loading_metric.js</span></h1>
    <h2>
        
        Statements: <span class="metric">16.43% <small>(35 / 213)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 83)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">5.56% <small>(1 / 18)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">100% <small>(1 / 1)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-lighthouse/node_modules/lighthouse/lighthouse-core/third_party/traceviewer-js/metrics/system_health/</a> &#187; loading_metric.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2</td><td class="line-coverage"><span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";require("../../base/category_util.js");require("../../base/statistics.js");require("../metric_registry.js");require("./utils.js");require("../../model/helpers/chrome_model_helper.js");require("../../model/timed_event.js");require("../../value/histogram.js");require("../../value/numeric.js");'use strict';global.tr.exportTo('tr.metrics.sh',function(){var RESPONSIVENESS_THRESHOLD=50;var INTERACTIVE_WINDOW_SIZE=5*1000;var timeDurationInMs_smallerIsBetter=tr.b.Unit.byName.timeDurationInMs_smallerIsBetter;var RelatedEventSet=tr.v.d.RelatedEventSet;<span class="fstat-no" title="function not covered" >function hasCategoryAndName(event,category,title){<span class="cstat-no" title="statement not covered" ></span>return event.title===title&amp;&amp;event.category&amp;&amp;tr.b.getCategoryParts(event.category).indexOf(category)!==-1;}<span class="fstat-no" title="function not covered" ></span>function findTargetRendererHelper(chromeHelper){<span class="cstat-no" title="statement not covered" ></span>var largestPid=-1;<span class="cstat-no" title="statement not covered" >f</span>or(var pid in chromeHelper.rendererHelpers){<span class="cstat-no" title="statement not covered" >var rendererHelper=chromeHelper.rendererHelpers[pid];<span class="cstat-no" title="statement not covered" >i</span>f(rendererHelper.isChromeTracingUI)<span class="cstat-no" title="statement not covered" >continue;<span class="cstat-no" title="statement not covered" >i</span></span>f(pid&gt;largestPid)<span class="cstat-no" title="statement not covered" >largestPid=pid;}<span class="cstat-no" title="statement not covered" ></span></span>i</span>f(largestPid===-1)<span class="cstat-no" title="statement not covered" >return undefined;<span class="cstat-no" title="statement not covered" >r</span></span>eturn chromeHelper.rendererHelpers[largestPid];}<span class="fstat-no" title="function not covered" ></span>function createBreakdownDiagnostic(rendererHelper,start,end){<span class="cstat-no" title="statement not covered" ></span>var breakdownDict=rendererHelper.generateTimeBreakdownTree(start,end);<span class="cstat-no" title="statement not covered" >v</span>ar breakdownDiagnostic=new tr.v.d.Breakdown();<span class="cstat-no" title="statement not covered" >b</span>reakdownDiagnostic.colorScheme=tr.v.d.COLOR_SCHEME_CHROME_USER_FRIENDLY_CATEGORY_DRIVER;<span class="cstat-no" title="statement not covered" >f</span>or(var label in breakdownDict){<span class="cstat-no" title="statement not covered" >breakdownDiagnostic.set(label,breakdownDict[label].total);}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn breakdownDiagnostic;}<span class="fstat-no" title="function not covered" ></span>function NavigationStartFinder(rendererHelper){<span class="cstat-no" title="statement not covered" ></span>this.navigationStartsForFrameId_={};<span class="cstat-no" title="statement not covered" >f</span>or(var ev of rendererHelper.mainThread.sliceGroup.childEvents()){<span class="cstat-no" title="statement not covered" >if(!hasCategoryAndName(ev,'blink.user_timing','navigationStart'))<span class="cstat-no" title="statement not covered" >continue;<span class="cstat-no" title="statement not covered" >v</span></span>ar frameIdRef=ev.args['frame'];<span class="cstat-no" title="statement not covered" >v</span>ar list=this.navigationStartsForFrameId_[frameIdRef];<span class="cstat-no" title="statement not covered" >i</span>f(list===undefined)<span class="cstat-no" title="statement not covered" >this.navigationStartsForFrameId_[frameIdRef]=list=[];<span class="cstat-no" title="statement not covered" >l</span></span>ist.unshift(ev);}</span>}</span>NavigationStartFinder.prototype={findNavigationStartEventForFrameBeforeTimestamp:<span class="fstat-no" title="function not covered" >function(frameIdRef,ts){<span class="cstat-no" title="statement not covered" ></span>var list=this.navigationStartsForFrameId_[frameIdRef];<span class="cstat-no" title="statement not covered" >i</span>f(list===undefined){<span class="cstat-no" title="statement not covered" >console.warn('No navigationStartEvent found for frame id "'+frameIdRef+'"');<span class="cstat-no" title="statement not covered" >r</span>eturn undefined;}<span class="cstat-no" title="statement not covered" ></span>v</span>ar eventBeforeTimestamp;<span class="cstat-no" title="statement not covered" >f</span>or(var ev of list){<span class="cstat-no" title="statement not covered" >if(ev.start&gt;ts)<span class="cstat-no" title="statement not covered" >continue;<span class="cstat-no" title="statement not covered" >i</span></span>f(eventBeforeTimestamp===undefined)<span class="cstat-no" title="statement not covered" >eventBeforeTimestamp=ev;}<span class="cstat-no" title="statement not covered" ></span></span>i</span>f(eventBeforeTimestamp===undefined){<span class="cstat-no" title="statement not covered" >console.warn('Failed to find navigationStartEvent.');<span class="cstat-no" title="statement not covered" >r</span>eturn undefined;}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn eventBeforeTimestamp;}</span>};var FIRST_PAINT_BOUNDARIES=tr.v.HistogramBinBoundaries.createLinear(0,1e3,20).addLinearBins(3e3,20).addExponentialBins(20e3,20);<span class="fstat-no" title="function not covered" >function createHistogram(name){<span class="cstat-no" title="statement not covered" ></span>var histogram=new tr.v.Histogram(name,timeDurationInMs_smallerIsBetter,FIRST_PAINT_BOUNDARIES);<span class="cstat-no" title="statement not covered" >h</span>istogram.customizeSummaryOptions({avg:true,count:false,max:true,min:true,std:true,sum:false,percentile:[0.90,0.95,0.99]});<span class="cstat-no" title="statement not covered" >r</span>eturn histogram;}<span class="fstat-no" title="function not covered" ></span>function findFrameLoaderSnapshotAt(rendererHelper,frameIdRef,ts){<span class="cstat-no" title="statement not covered" ></span>var snapshot;<span class="cstat-no" title="statement not covered" >v</span>ar objects=rendererHelper.process.objects;<span class="cstat-no" title="statement not covered" >v</span>ar frameLoaderInstances=objects.instancesByTypeName_['FrameLoader'];<span class="cstat-no" title="statement not covered" >i</span>f(frameLoaderInstances===undefined){<span class="cstat-no" title="statement not covered" >console.warn('Failed to find FrameLoader for frameId "'+frameIdRef+'" at ts '+ts+', the trace maybe incomplete or from an old'+'Chrome.');<span class="cstat-no" title="statement not covered" >r</span>eturn undefined;}<span class="cstat-no" title="statement not covered" ></span>v</span>ar snapshot;<span class="cstat-no" title="statement not covered" >f</span>or(var instance of frameLoaderInstances){<span class="cstat-no" title="statement not covered" >if(!instance.isAliveAt(ts))<span class="cstat-no" title="statement not covered" >continue;<span class="cstat-no" title="statement not covered" >v</span></span>ar maybeSnapshot=instance.getSnapshotAt(ts);<span class="cstat-no" title="statement not covered" >i</span>f(frameIdRef!==maybeSnapshot.args['frame']['id_ref'])<span class="cstat-no" title="statement not covered" >continue;<span class="cstat-no" title="statement not covered" >s</span></span>napshot=maybeSnapshot;}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn snapshot;}<span class="fstat-no" title="function not covered" ></span>function findAllUserTimingEvents(rendererHelper,title){<span class="cstat-no" title="statement not covered" ></span>var targetEvents=[];<span class="cstat-no" title="statement not covered" >f</span>or(var ev of rendererHelper.process.getDescendantEvents()){<span class="cstat-no" title="statement not covered" >if(!hasCategoryAndName(ev,'blink.user_timing',title))<span class="cstat-no" title="statement not covered" >continue;<span class="cstat-no" title="statement not covered" >t</span></span>argetEvents.push(ev);}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn targetEvents;}<span class="fstat-no" title="function not covered" ></span>function findFirstMeaningfulPaintCandidates(rendererHelper){<span class="cstat-no" title="statement not covered" ></span>var isTelemetryInternalEvent=prepareTelemetryInternalEventPredicate(rendererHelper);<span class="cstat-no" title="statement not covered" >v</span>ar candidatesForFrameId={};<span class="cstat-no" title="statement not covered" >f</span>or(var ev of rendererHelper.process.getDescendantEvents()){<span class="cstat-no" title="statement not covered" >if(!hasCategoryAndName(ev,'loading','firstMeaningfulPaintCandidate'))<span class="cstat-no" title="statement not covered" >continue;<span class="cstat-no" title="statement not covered" >i</span></span>f(isTelemetryInternalEvent(ev))<span class="cstat-no" title="statement not covered" >continue;<span class="cstat-no" title="statement not covered" >v</span></span>ar frameIdRef=ev.args['frame'];<span class="cstat-no" title="statement not covered" >i</span>f(frameIdRef===undefined)<span class="cstat-no" title="statement not covered" >continue;<span class="cstat-no" title="statement not covered" >v</span></span>ar list=candidatesForFrameId[frameIdRef];<span class="cstat-no" title="statement not covered" >i</span>f(list===undefined)<span class="cstat-no" title="statement not covered" >candidatesForFrameId[frameIdRef]=list=[];<span class="cstat-no" title="statement not covered" >l</span></span>ist.push(ev);}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn candidatesForFrameId;}<span class="fstat-no" title="function not covered" ></span>function prepareTelemetryInternalEventPredicate(rendererHelper){<span class="cstat-no" title="statement not covered" ></span>var ignoreRegions=[];<span class="cstat-no" title="statement not covered" >v</span>ar internalRegionStart;<span class="cstat-no" title="statement not covered" >f</span>or(var slice of rendererHelper.mainThread.asyncSliceGroup.getDescendantEvents()){<span class="cstat-no" title="statement not covered" >if(!!slice.title.match(/^telemetry\.internal\.[^.]*\.start$/))<span class="cstat-no" title="statement not covered" >internalRegionStart=slice.start;<span class="cstat-no" title="statement not covered" >i</span></span>f(!!slice.title.match(/^telemetry\.internal\.[^.]*\.end$/)){<span class="cstat-no" title="statement not covered" >var timedEvent=new tr.model.TimedEvent(internalRegionStart);<span class="cstat-no" title="statement not covered" >t</span>imedEvent.duration=slice.end-internalRegionStart;<span class="cstat-no" title="statement not covered" >i</span>gnoreRegions.push(timedEvent);}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn <span class="fstat-no" title="function not covered" >function isTelemetryInternalEvent(slice){<span class="cstat-no" title="statement not covered" ></span>for(var region of ignoreRegions)<span class="cstat-no" title="statement not covered" >if(region.bounds(slice))<span class="cstat-no" title="statement not covered" >return true;<span class="cstat-no" title="statement not covered" >r</span></span></span>eturn false;}</span>;}</span>var URL_BLACKLIST=['about:blank','data:text/html,pluginplaceholderdata'];<span class="fstat-no" title="function not covered" >function shouldIgnoreURL(url){<span class="cstat-no" title="statement not covered" ></span>return URL_BLACKLIST.indexOf(url)&gt;=0;}</span>var METRICS=[{valueName:'timeToFirstContentfulPaint',title:'firstContentfulPaint',description:'time to first contentful paint'},{valueName:'timeToOnload',title:'loadEventStart',description:'time to onload. '+'This is temporary metric used for PCv1/v2 sanity checking'}];<span class="fstat-no" title="function not covered" >function timeToFirstContentfulPaintMetric(values,model){<span class="cstat-no" title="statement not covered" ></span>var chromeHelper=model.getOrCreateHelper(tr.model.helpers.ChromeModelHelper);<span class="cstat-no" title="statement not covered" >v</span>ar rendererHelper=findTargetRendererHelper(chromeHelper);<span class="cstat-no" title="statement not covered" >v</span>ar isTelemetryInternalEvent=prepareTelemetryInternalEventPredicate(rendererHelper);<span class="cstat-no" title="statement not covered" >v</span>ar navigationStartFinder=new NavigationStartFinder(rendererHelper);<span class="cstat-no" title="statement not covered" >f</span>or(var metric of METRICS){<span class="cstat-no" title="statement not covered" >var histogram=createHistogram(metric.valueName);<span class="cstat-no" title="statement not covered" >h</span>istogram.description=metric.description;<span class="cstat-no" title="statement not covered" >v</span>ar targetEvents=findAllUserTimingEvents(rendererHelper,metric.title);<span class="cstat-no" title="statement not covered" >f</span>or(var ev of targetEvents){<span class="cstat-no" title="statement not covered" >if(isTelemetryInternalEvent(ev))<span class="cstat-no" title="statement not covered" >continue;<span class="cstat-no" title="statement not covered" >v</span></span>ar frameIdRef=ev.args['frame'];<span class="cstat-no" title="statement not covered" >v</span>ar snapshot=findFrameLoaderSnapshotAt(rendererHelper,frameIdRef,ev.start);<span class="cstat-no" title="statement not covered" >i</span>f(snapshot===undefined||!snapshot.args.isLoadingMainFrame)<span class="cstat-no" title="statement not covered" >continue;<span class="cstat-no" title="statement not covered" >v</span></span>ar url=snapshot.args.documentLoaderURL;<span class="cstat-no" title="statement not covered" >i</span>f(shouldIgnoreURL(url))<span class="cstat-no" title="statement not covered" >continue;<span class="cstat-no" title="statement not covered" >v</span></span>ar navigationStartEvent=navigationStartFinder.findNavigationStartEventForFrameBeforeTimestamp(frameIdRef,ev.start);<span class="cstat-no" title="statement not covered" >i</span>f(navigationStartEvent===undefined)<span class="cstat-no" title="statement not covered" >continue;<span class="cstat-no" title="statement not covered" >v</span></span>ar timeToEvent=ev.start-navigationStartEvent.start;<span class="cstat-no" title="statement not covered" >h</span>istogram.addSample(timeToEvent,{url:new tr.v.d.Generic(url)});}<span class="cstat-no" title="statement not covered" ></span>v</span>alues.addHistogram(histogram);}</span>}<span class="fstat-no" title="function not covered" ></span>function addTimeToInteractiveSampleToHistogram(histogram,rendererHelper,navigationStart,firstMeaningfulPaint,url){<span class="cstat-no" title="statement not covered" ></span>if(shouldIgnoreURL(url))<span class="cstat-no" title="statement not covered" >return;<span class="cstat-no" title="statement not covered" >v</span></span>ar navigationStartTime=navigationStart.start;<span class="cstat-no" title="statement not covered" >v</span>ar firstInteractive=Infinity;<span class="cstat-no" title="statement not covered" >v</span>ar firstInteractiveCandidate=firstMeaningfulPaint;<span class="cstat-no" title="statement not covered" >v</span>ar lastLongTaskEvent=undefined;<span class="cstat-no" title="statement not covered" >f</span>or(var ev of[...rendererHelper.mainThread.sliceGroup.childEvents()]){<span class="cstat-no" title="statement not covered" >if(ev.start&lt;firstInteractiveCandidate)<span class="cstat-no" title="statement not covered" >continue;<span class="cstat-no" title="statement not covered" >v</span></span>ar interactiveDurationSoFar=ev.start-firstInteractiveCandidate;<span class="cstat-no" title="statement not covered" >i</span>f(interactiveDurationSoFar&gt;=INTERACTIVE_WINDOW_SIZE){<span class="cstat-no" title="statement not covered" >firstInteractive=firstInteractiveCandidate;<span class="cstat-no" title="statement not covered" >b</span>reak;}<span class="cstat-no" title="statement not covered" ></span>i</span>f(ev.title==='TaskQueueManager::ProcessTaskFromWorkQueue'&amp;&amp;ev.duration&gt;RESPONSIVENESS_THRESHOLD){<span class="cstat-no" title="statement not covered" >firstInteractiveCandidate=ev.end-50;<span class="cstat-no" title="statement not covered" >l</span>astLongTaskEvent=ev;}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar breakdownDiagnostic=createBreakdownDiagnostic(rendererHelper,navigationStartTime,firstInteractive);<span class="cstat-no" title="statement not covered" >v</span>ar timeToFirstInteractive=firstInteractive-navigationStartTime;<span class="cstat-no" title="statement not covered" >h</span>istogram.addSample(timeToFirstInteractive,{"Start":new RelatedEventSet(navigationStart),"Last long task":new RelatedEventSet(lastLongTaskEvent),"Navigation infos":new tr.v.d.Generic({url:url,pid:rendererHelper.pid,start:navigationStartTime,interactive:firstInteractive}),"Breakdown of [navStart, Interactive]":breakdownDiagnostic});}<span class="fstat-no" title="function not covered" ></span>function timeToFirstMeaningfulPaintAndTimeToInteractiveMetrics(values,model){<span class="cstat-no" title="statement not covered" ></span>var chromeHelper=model.getOrCreateHelper(tr.model.helpers.ChromeModelHelper);<span class="cstat-no" title="statement not covered" >v</span>ar rendererHelper=findTargetRendererHelper(chromeHelper);<span class="cstat-no" title="statement not covered" >v</span>ar navigationStartFinder=new NavigationStartFinder(rendererHelper);<span class="cstat-no" title="statement not covered" >v</span>ar firstMeaningfulPaintHistogram=createHistogram('timeToFirstMeaningfulPaint');<span class="cstat-no" title="statement not covered" >f</span>irstMeaningfulPaintHistogram.description='time to first meaningful paint';<span class="cstat-no" title="statement not covered" >v</span>ar firstInteractiveHistogram=createHistogram('timeToFirstInteractive');<span class="cstat-no" title="statement not covered" >f</span>irstInteractiveHistogram.description='time to first interactive';<span class="fstat-no" title="function not covered" >f</span>unction addFirstMeaningfulPaintSampleToHistogram(frameIdRef,navigationStart,fmpMarkerEvent){<span class="cstat-no" title="statement not covered" ></span>var snapshot=findFrameLoaderSnapshotAt(rendererHelper,frameIdRef,fmpMarkerEvent.start);<span class="cstat-no" title="statement not covered" >i</span>f(snapshot===undefined||!snapshot.args.isLoadingMainFrame)<span class="cstat-no" title="statement not covered" >return;<span class="cstat-no" title="statement not covered" >v</span></span>ar url=snapshot.args.documentLoaderURL;<span class="cstat-no" title="statement not covered" >i</span>f(shouldIgnoreURL(url))<span class="cstat-no" title="statement not covered" >return;<span class="cstat-no" title="statement not covered" >v</span></span>ar timeToFirstMeaningfulPaint=fmpMarkerEvent.start-navigationStart.start;<span class="cstat-no" title="statement not covered" >v</span>ar extraDiagnostic={url:url,pid:rendererHelper.pid};<span class="cstat-no" title="statement not covered" >v</span>ar breakdownDiagnostic=createBreakdownDiagnostic(rendererHelper,navigationStart.start,fmpMarkerEvent.start);<span class="cstat-no" title="statement not covered" >f</span>irstMeaningfulPaintHistogram.addSample(timeToFirstMeaningfulPaint,{"Breakdown of [navStart, FMP]":breakdownDiagnostic,"Start":new RelatedEventSet(navigationStart),"End":new RelatedEventSet(fmpMarkerEvent),"Navigation infos":new tr.v.d.Generic({url:url,pid:rendererHelper.pid,start:navigationStart.start,fmp:fmpMarkerEvent.start})});<span class="cstat-no" title="statement not covered" >r</span>eturn{firstMeaningfulPaint:fmpMarkerEvent.start,url:url};}<span class="cstat-no" title="statement not covered" ></span>var candidatesForFrameId=findFirstMeaningfulPaintCandidates(rendererHelper);<span class="cstat-no" title="statement not covered" >f</span>or(var frameIdRef in candidatesForFrameId){<span class="cstat-no" title="statement not covered" >var navigationStart;<span class="cstat-no" title="statement not covered" >v</span>ar lastCandidate;<span class="cstat-no" title="statement not covered" >f</span>or(var ev of candidatesForFrameId[frameIdRef]){<span class="cstat-no" title="statement not covered" >var navigationStartForThisCandidate=navigationStartFinder.findNavigationStartEventForFrameBeforeTimestamp(frameIdRef,ev.start);<span class="cstat-no" title="statement not covered" >i</span>f(navigationStartForThisCandidate===undefined)<span class="cstat-no" title="statement not covered" >continue;<span class="cstat-no" title="statement not covered" >i</span></span>f(navigationStart!==navigationStartForThisCandidate){<span class="cstat-no" title="statement not covered" >if(navigationStart!==undefined&amp;&amp;lastCandidate!==undefined){<span class="cstat-no" title="statement not covered" >data=addFirstMeaningfulPaintSampleToHistogram(frameIdRef,navigationStart,lastCandidate);<span class="cstat-no" title="statement not covered" >i</span>f(data!==undefined)<span class="cstat-no" title="statement not covered" >addTimeToInteractiveSampleToHistogram(firstInteractiveHistogram,rendererHelper,navigationStart,data.firstMeaningfulPaint,data.url);}<span class="cstat-no" title="statement not covered" ></span></span>n</span>avigationStart=navigationStartForThisCandidate;}<span class="cstat-no" title="statement not covered" ></span>l</span>astCandidate=ev;}<span class="cstat-no" title="statement not covered" ></span>i</span>f(lastCandidate!==undefined){<span class="cstat-no" title="statement not covered" >var data=addFirstMeaningfulPaintSampleToHistogram(frameIdRef,navigationStart,lastCandidate);<span class="cstat-no" title="statement not covered" >i</span>f(data!==undefined)<span class="cstat-no" title="statement not covered" >addTimeToInteractiveSampleToHistogram(firstInteractiveHistogram,rendererHelper,navigationStart,data.firstMeaningfulPaint,data.url);}</span></span>}<span class="cstat-no" title="statement not covered" ></span>v</span>alues.addHistogram(firstMeaningfulPaintHistogram);<span class="cstat-no" title="statement not covered" >v</span>alues.addHistogram(firstInteractiveHistogram);}<span class="fstat-no" title="function not covered" ></span>function loadingMetric(values,model){<span class="cstat-no" title="statement not covered" ></span>timeToFirstContentfulPaintMetric(values,model);<span class="cstat-no" title="statement not covered" >t</span>imeToFirstMeaningfulPaintAndTimeToInteractiveMetrics(values,model);}</span>tr.metrics.MetricRegistry.register(loadingMetric);return{loadingMetric:loadingMetric};});
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Fri Apr 21 2017 14:21:24 GMT+0000 (UTC)</div>
</div>
</body>
</html>
